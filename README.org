#+title: emacs-comment-translate

Show translations for comments in a posframe when you hover (idle at point or
mouse position).

* Requirements

- Emacs 27+
- posframe
- Network access (default backend uses Google Translate's unofficial endpoint)

* Install

Put ~comment-translate.el~ on your ~load-path~ and enable the mode:

#+begin_src elisp
(require 'comment-translate)
(comment-translate-mode 1)
;; or
(global-comment-translate-mode 1)
#+end_src

* Configuration

#+begin_src elisp
(setq comment-translate-target-language "ja"
      comment-translate-source-language "auto"
      comment-translate-idle-delay 0.6
      comment-translate-hover-source 'mouse)
#+end_src

* Custom translator

By default this plugin uses Google Translate's unofficial endpoint
as an asynchronous backend. If you want to use your own backend, provide
a function:

- Sync: ~(fn TEXT)~ => return translated string
- Async: ~(fn TEXT CALLBACK)~ and call ~(funcall CALLBACK TRANSLATION ERROR)~

#+begin_src elisp
(defun my-comment-translate (text)
  ;; Return translated string synchronously.
  (concat "[translated] " text))

(setq comment-translate-translate-function #'my-comment-translate)
#+end_src

* Google endpoint

You can change the endpoint if needed:

#+begin_src elisp
(setq comment-translate-google-endpoint
      "https://translate.googleapis.com/translate_a/single")
#+end_src

* Commands

- ~comment-translate-show~ - show translation at the current hover location
- ~comment-translate-hide~ - hide the posframe
- ~comment-translate-clear-cache~ - clear the translation cache

